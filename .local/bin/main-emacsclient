#!/usr/bin/env bash

max_count=100
count=0

if ! emacsclient -e '(emacs-pid)' >/dev/null 2>&1; then
    emacs --daemon
fi

until emacsclient -e '(emacs-pid)' >/dev/null 2>&1; do
    (( count++ > max_count )) && exit 1
    sleep 0.1
done

frame_params='((name . "main-emacs")
               (width . 120)
               (height . 45))'

emacsclient \
    --alternate-editor= \
    --create-frame \
    --frame-parameters="$frame_params" \
    "$@" &
